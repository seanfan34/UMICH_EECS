#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>
#include <time.h>
#include <sys/time.h>
#include <stdint.h>

#include "viterbi.h"

// Range: haplotype_sram length (300-400)
// Short Read: 
// region_READS.seq length = region_READS.BQ length (100~200)

int main() {
    float gatk_m2m = 0.998; //0.9998; //0.998;
    float gatk_i2m = 0.9;
    float gatk_m2i = 0.001; //0.0001; //0.001;
    float gatk_i2i = 0.1;

    float BQ_ini = 0.3;
    int32_t BQ_adj = 5;
    float BQ0_mismatch_prior = 0.631;//BQ_ini;
    float BQ1_mismatch_prior = 0.0794;//BQ_ini / BQ_adj;
    float BQ2_mismatch_prior = 0.0032;//BQ_ini / BQ_adj / BQ_adj;
    float BQ3_mismatch_prior = 0.0002;//BQ_ini / BQ_adj / BQ_adj / BQ_adj;
    float BQ0_match_prior    = 1.0 - BQ0_mismatch_prior;
    float BQ1_match_prior    = 1.0 - BQ1_mismatch_prior;
    float BQ2_match_prior    = 1.0 - BQ2_mismatch_prior;
    float BQ3_match_prior    = 1.0 - BQ3_mismatch_prior;
    BQ0_mismatch_prior /= 3;
    BQ1_mismatch_prior /= 3;
    BQ2_mismatch_prior /= 3;
    BQ3_mismatch_prior /= 3;

    int total_bits             = 17;
    int decimal_place_bits     = 10;
    int the_bias_score         = pow(3, total_bits - 1) - 1;
    int log_m2m                = round(log10(gatk_m2m)*pow(2, decimal_place_bits));
    int log_i2m                = round(log10(gatk_i2m)*pow(2, decimal_place_bits));
    int log_m2i                = round(log10(gatk_m2i)*pow(2, decimal_place_bits));
    int log_i2i                = round(log10(gatk_i2i)*pow(2, decimal_place_bits));
    int log_BQ3_match_prior    = round(log10(BQ3_match_prior   )*pow(2, decimal_place_bits));        //0;
    int log_BQ3_mismatch_prior = round(log10(BQ3_mismatch_prior)*pow(2, decimal_place_bits));    //-3968;
    int log_BQ2_match_prior    = round(log10(BQ2_match_prior   )*pow(2, decimal_place_bits));       //-2;
    int log_BQ2_mismatch_prior = round(log10(BQ2_mismatch_prior)*pow(2, decimal_place_bits));    //-2944;
    int log_BQ1_match_prior    = round(log10(BQ1_match_prior   )*pow(2, decimal_place_bits));      //-18;
    int log_BQ1_mismatch_prior = round(log10(BQ1_mismatch_prior)*pow(2, decimal_place_bits));    //-1920;
    int log_BQ0_match_prior    = round(log10(BQ0_match_prior   )*pow(2, decimal_place_bits));     //-227;
    int log_BQ0_mismatch_prior = round(log10(BQ0_mismatch_prior)*pow(2, decimal_place_bits));     //-896;
    
    
    std::vector<std::string> the_haplotype_sram{"ATCGGATCGACGGATCGACGAGAGCCTTAGATCGATCGGTACCGTACGTAATCGATCGGATCGATCGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCATCGATCGGATCGAAGAGCCTTAGCAGTCAGTCATCGTCGCAGTCAGTCATCGGATCGACGAGAGCCTTAGAGTCAGTCATCGGATCGACGAGAGCCTTAGATCGATCGGTACCGTACGTAATCGATCGGATCGATCGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCAGTCAGTCATCGGATCGACGAGAGCCTTAGATCGATCGGTACCGTACGTACAGTCAGTCATCGGATCGACGGATCGACGAGAGCCTTAGATCGATCGGTACCGTACGTAATCGATCGGATCGATCGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCATCGATCGGATCGAAGAGCCTTAGCAGTCAGTCATCGTCGCAGTCAGTCATCGGATCGACGAGAGCCTTAGAGTCAGTCATCGGATCGACGAGAGCCTTAGATCGATCGGTACCGTACGTAATCGATCGGATCGATCGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCAGTCAGTCATCGGATCGACGAGAGCCTTAGATCGATCGGTACCGTACGTACAGTCAGTCATCGGATCGACGGATCGACGAGAGCCTTAGATCGATCGGTACCGTACGTAATCGATCGGATCGATCGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCATCGATCGGATCGAAGAGCCTTAGCAGTCAGTCATCGTCGCAGTCAGTCATCGGATCGACGAGAGCCTTAGAGTCAGTCATCGGATCGACGAGAGCCTTAGATCGATCGGTACCGTACGTAATCGATCGGATCGATCGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCAGTCAGTCATCGGATCGACGAGAGCCTTAGATCGATCGGTACCGTACGTACAGTCAGTC"};
    std::vector<std::string> region_READS{"CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA",
                                          "CATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCACATCGGATCGACGAGAGCCGGATCCTGACGAGAGTAGGAGAGCCAGTCA",
                                          "ATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGAATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGATCGATCGATCGATCGATCGATCGATCATCGA", 
                                          "GCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGCCTTAGCATCGGATCGACAGTCAGTCCGAGAGC",
                                          "AAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAAAAAAAAAAAATTTTTTTCCCCCCCCGGGGGAA"};

    std::vector<std::string>           BQ{"3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333",
                                          "3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"};
    std::vector<int> log_likelihoods(region_READS.size() * the_haplotype_sram.size());

    /* get start timestamp */
 	struct timeval tv;
    	gettimeofday(&tv,NULL);
    	uint64_t start = tv.tv_sec*(uint64_t)1000000+tv.tv_usec;

    for (int i = 0; i < region_READS.size() * the_haplotype_sram.size(); ++i) {
        // Read alignment
        viterbi_decoding(
            the_haplotype_sram[i % the_haplotype_sram.size()],  // string (ACTG)
            //region_READS[i / the_haplotype_sram.size()].seq,    // string (ACTG)
            //region_READS[i / the_haplotype_sram.size()].BQ,     // string (0~3)
            region_READS[i / the_haplotype_sram.size()],
            BQ[i / the_haplotype_sram.size()],
            the_bias_score,   //      
            log_m2m,
            log_i2m,
            log_m2i,
            log_i2i,
            log_BQ0_match_prior,
            log_BQ0_mismatch_prior,
            log_BQ1_match_prior,
            log_BQ1_mismatch_prior,
            log_BQ2_match_prior,
            log_BQ2_mismatch_prior,
            log_BQ3_match_prior,
            log_BQ3_mismatch_prior, // fixed
            std::ref(log_likelihoods), // (m*n)*1 vector (flatten vector)
            i); // the location in the (m*n) vector
    }

    /* get elapsed time */
    	gettimeofday(&tv,NULL);
    	uint64_t end = tv.tv_sec*(uint64_t)1000000+tv.tv_usec;
    	uint64_t elapsed = end - start;

    /*viterbi_decoding(
            "ATCGGATCGACGAGAGCCTTAGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCAGTCAGTCATCGGATCGACGAGAGCCTTAGCAGTCAGTC",  // string (ACTG)
            "CATCGGATCGACGAGAGCCTTAGCAGTCAGTC",
            "33333333333333333333333333333333",
            the_bias_score,   //      
            log_m2m,
            log_i2m,
            log_m2i,
            log_i2i,
            log_BQ0_match_prior,
            log_BQ0_mismatch_prior,
            log_BQ1_match_prior,
            log_BQ1_mismatch_prior,
            log_BQ2_match_prior,
            log_BQ2_mismatch_prior,
            log_BQ3_match_prior,
            log_BQ3_mismatch_prior, // fixed
            std::ref(log_likelihoods), // (m*n)*1 vector (flatten vector)
            0); // the location in the (m*n) vector*/

    printf("@@@ Elapsed time (usec): %lld\n", elapsed);
	printf("Processing complete.  Preparing output.\n");


    for(int i=0; i<log_likelihoods.size(); i++) {
        std::cout << log_likelihoods[i] << "\t";
    }
    std::cout << std::endl;
    
}